--// üå™Ô∏è JSY Wind UI HD - Fishing + Lokasi + Auto Touch (Fixed Respawn Version)
local player = game.Players.LocalPlayer
local coregui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Hapus GUI lama jika ada
if coregui:FindFirstChild("JSY_WindUI") then
	coregui.JSY_WindUI:Destroy()
end
if coregui:FindFirstChild("JSY_Minimized") then
	coregui.JSY_Minimized:Destroy()
end

--// GUI
local gui = Instance.new("ScreenGui", coregui)
gui.Name = "JSY_WindUI"
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.ResetOnSpawn = false

--// Floating Minimized Button
local minimizedGui = Instance.new("ScreenGui", coregui)
minimizedGui.Name = "JSY_Minimized"
minimizedGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
minimizedGui.ResetOnSpawn = false
minimizedGui.Enabled = false

local floatingBtn = Instance.new("TextButton", minimizedGui)
floatingBtn.Size = UDim2.new(0, 50, 0, 50)
floatingBtn.Position = UDim2.new(0, 20, 0.5, -25)
floatingBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
floatingBtn.Text = "üê¨"
floatingBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
floatingBtn.Font = Enum.Font.GothamBold
floatingBtn.TextSize = 20
floatingBtn.BorderSizePixel = 0
floatingBtn.Active = true
floatingBtn.Draggable = true
Instance.new("UICorner", floatingBtn).CornerRadius = UDim.new(1, 0)

-- Border glow effect untuk floating button
local floatingBorder = Instance.new("Frame", floatingBtn)
floatingBorder.Size = UDim2.new(1, 4, 1, 4)
floatingBorder.Position = UDim2.new(0, -2, 0, -2)
floatingBorder.BackgroundColor3 = Color3.fromRGB(70, 130, 255)
floatingBorder.BackgroundTransparency = 0.7
floatingBorder.BorderSizePixel = 0
floatingBorder.ZIndex = 0
Instance.new("UICorner", floatingBorder).CornerRadius = UDim.new(1, 0)

--// Main Frame dengan efek glass morphism
local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 320, 0, 350)
main.Position = UDim2.new(0.5, -160, 0.5, -175)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
main.BackgroundTransparency = 0.1
main.Active = true
main.Draggable = true
main.BorderSizePixel = 0

-- Efek glass morphism
local gradient = Instance.new("UIGradient", main)
gradient.Rotation = 90
gradient.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 35)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
})

Instance.new("UICorner", main).CornerRadius = UDim.new(0, 12)

-- Border glow effect
local border = Instance.new("Frame", main)
border.Size = UDim2.new(1, 4, 1, 4)
border.Position = UDim2.new(0, -2, 0, -2)
border.BackgroundColor3 = Color3.fromRGB(70, 130, 255)
border.BackgroundTransparency = 0.8
border.BorderSizePixel = 0
border.ZIndex = 0
Instance.new("UICorner", border).CornerRadius = UDim.new(0, 14)

--// Navbar dengan efek modern
local navbar = Instance.new("Frame", main)
navbar.Size = UDim2.new(1, -8, 0, 40)
navbar.Position = UDim2.new(0, 4, 0, 4)
navbar.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
navbar.BackgroundTransparency = 0.2
navbar.BorderSizePixel = 0
Instance.new("UICorner", navbar).CornerRadius = UDim.new(0, 10)

local title = Instance.new("TextLabel", navbar)
title.Size = UDim2.new(0.6, 0, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Text = "JSY FISH IT"
title.TextColor3 = Color3.fromRGB(220, 220, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.TextXAlignment = Enum.TextXAlignment.Left

-- Tombol minimize dan close
local buttonContainer = Instance.new("Frame", navbar)
buttonContainer.Size = UDim2.new(0, 60, 1, 0)
buttonContainer.Position = UDim2.new(1, -65, 0, 0)
buttonContainer.BackgroundTransparency = 1

local minimizeBtn = Instance.new("TextButton", buttonContainer)
minimizeBtn.Size = UDim2.new(0, 25, 0, 25)
minimizeBtn.Position = UDim2.new(0, 0, 0.5, -12.5)
minimizeBtn.BackgroundColor3 = Color3.fromRGB(255, 180, 0)
minimizeBtn.Text = "‚îÄ"
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.TextSize = 16
minimizeBtn.BorderSizePixel = 0
Instance.new("UICorner", minimizeBtn).CornerRadius = UDim.new(1, 0)

local closeBtn = Instance.new("TextButton", buttonContainer)
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -25, 0.5, -12.5)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
closeBtn.Text = "√ó"
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.BorderSizePixel = 0
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1, 0)

--// Tab Container dengan design modern
local tabContainer = Instance.new("Frame", main)
tabContainer.Size = UDim2.new(1, -16, 0, 30)
tabContainer.Position = UDim2.new(0, 8, 0, 50)
tabContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
tabContainer.BackgroundTransparency = 0.3
tabContainer.BorderSizePixel = 0
Instance.new("UICorner", tabContainer).CornerRadius = UDim.new(0, 8)

local uiList = Instance.new("UIListLayout", tabContainer)
uiList.FillDirection = Enum.FillDirection.Horizontal
uiList.Padding = UDim.new(0, 4)
uiList.HorizontalAlignment = Enum.HorizontalAlignment.Center
uiList.VerticalAlignment = Enum.VerticalAlignment.Center

local tabs = {"Fishing", "Lokasi"}
local tabButtons = {}
local frames = {}

--// Fungsi buat tombol tab modern
local function createTab(name, displayName)
	local btn = Instance.new("TextButton", tabContainer)
	btn.Size = UDim2.new(0.45, 0, 0, 24)
	btn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
	btn.Text = displayName or name
	btn.TextColor3 = Color3.fromRGB(200, 200, 220)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 12
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	
	local corner = Instance.new("UICorner", btn)
	corner.CornerRadius = UDim.new(0, 6)
	
	-- Hover effect
	btn.MouseEnter:Connect(function()
		if frames[name] ~= nil and not frames[name].Visible then
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 50, 65)}):Play()
		end
	end)
	
	btn.MouseLeave:Connect(function()
		if frames[name] ~= nil and not frames[name].Visible then
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(40, 40, 50)}):Play()
		end
	end)
	
	tabButtons[name] = btn
	return btn
end

--// Frame Container
local content = Instance.new("Frame", main)
content.Size = UDim2.new(1, -16, 1, -90)
content.Position = UDim2.new(0, 8, 0, 85)
content.BackgroundTransparency = 1

--// FISHING TAB - Design Modern dengan Checklist (FIXED FRAME)
local fishingFrame = Instance.new("Frame", content)
fishingFrame.Size = UDim2.new(1, 0, 1, 0)
fishingFrame.BackgroundTransparency = 1
fishingFrame.Visible = false
frames["Fishing"] = fishingFrame

-- Frame utama untuk fishing card (DIPERBAIKI AGAR TIDAK TEMBUS)
local fishingCard = Instance.new("Frame", fishingFrame)
fishingCard.Size = UDim2.new(1, 0, 1, 0) -- Sesuaikan dengan parent
fishingCard.Position = UDim2.new(0, 0, 0, 0)
fishingCard.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
fishingCard.BackgroundTransparency = 0.2
fishingCard.BorderSizePixel = 0
fishingCard.ClipsDescendants = true -- PENTING: Agar tidak tembus keluar frame
Instance.new("UICorner", fishingCard).CornerRadius = UDim.new(0, 10)

-- Inner container untuk konten fishing
local fishingContent = Instance.new("Frame", fishingCard)
fishingContent.Size = UDim2.new(1, -16, 1, -16)
fishingContent.Position = UDim2.new(0, 8, 0, 8)
fishingContent.BackgroundTransparency = 1

local titleFish = Instance.new("TextLabel", fishingContent)
titleFish.Size = UDim2.new(1, 0, 0, 35)
titleFish.BackgroundTransparency = 1
titleFish.Text = "üé£ AUTO FISHING"
titleFish.TextColor3 = Color3.fromRGB(220, 220, 255)
titleFish.Font = Enum.Font.GothamBold
titleFish.TextSize = 14
titleFish.TextXAlignment = Enum.TextXAlignment.Center

--// Checklist Container
local checklistContainer = Instance.new("Frame", fishingContent)
checklistContainer.Size = UDim2.new(1, 0, 0, 150)
checklistContainer.Position = UDim2.new(0, 0, 0, 40)
checklistContainer.BackgroundTransparency = 1

local checklistLayout = Instance.new("UIListLayout", checklistContainer)
checklistLayout.Padding = UDim.new(0, 10)

--// Auto Fishing Checklist
local autoFishingItem = Instance.new("Frame", checklistContainer)
autoFishingItem.Size = UDim2.new(1, 0, 0, 30)
autoFishingItem.BackgroundTransparency = 1

local autoFishingCheckbox = Instance.new("TextButton", autoFishingItem)
autoFishingCheckbox.Size = UDim2.new(0, 25, 0, 25)
autoFishingCheckbox.Position = UDim2.new(0, 0, 0.5, -12.5)
autoFishingCheckbox.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
autoFishingCheckbox.Text = ""  -- AWALNYA KOSONG
autoFishingCheckbox.TextColor3 = Color3.fromRGB(255, 255, 255)
autoFishingCheckbox.Font = Enum.Font.GothamBold
autoFishingCheckbox.TextSize = 16
autoFishingCheckbox.BorderSizePixel = 0
Instance.new("UICorner", autoFishingCheckbox).CornerRadius = UDim.new(0, 5)

local autoFishingLabel = Instance.new("TextLabel", autoFishingItem)
autoFishingLabel.Size = UDim2.new(1, -35, 1, 0)
autoFishingLabel.Position = UDim2.new(0, 30, 0, 0)
autoFishingLabel.BackgroundTransparency = 1
autoFishingLabel.Text = "AUTO MANCING"
autoFishingLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
autoFishingLabel.Font = Enum.Font.GothamBold
autoFishingLabel.TextSize = 13
autoFishingLabel.TextXAlignment = Enum.TextXAlignment.Left

--// FREEZE Checklist
local freezeItem = Instance.new("Frame", checklistContainer)
freezeItem.Size = UDim2.new(1, 0, 0, 30)
freezeItem.BackgroundTransparency = 1

local freezeCheckbox = Instance.new("TextButton", freezeItem)
freezeCheckbox.Size = UDim2.new(0, 25, 0, 25)
freezeCheckbox.Position = UDim2.new(0, 0, 0.5, -12.5)
freezeCheckbox.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
freezeCheckbox.Text = ""  -- AWALNYA KOSONG
freezeCheckbox.TextColor3 = Color3.fromRGB(255, 255, 255)
freezeCheckbox.Font = Enum.Font.GothamBold
freezeCheckbox.TextSize = 16
freezeCheckbox.BorderSizePixel = 0
Instance.new("UICorner", freezeCheckbox).CornerRadius = UDim.new(0, 5)

local freezeLabel = Instance.new("TextLabel", freezeItem)
freezeLabel.Size = UDim2.new(1, -35, 1, 0)
freezeLabel.Position = UDim2.new(0, 30, 0, 0)
freezeLabel.BackgroundTransparency = 1
freezeLabel.Text = "FREEZE"
freezeLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
freezeLabel.Font = Enum.Font.GothamBold
freezeLabel.TextSize = 13
freezeLabel.TextXAlignment = Enum.TextXAlignment.Left

--// AFK Checklist
local afkItem = Instance.new("Frame", checklistContainer)
afkItem.Size = UDim2.new(1, 0, 0, 30)
afkItem.BackgroundTransparency = 1

local afkCheckbox = Instance.new("TextButton", afkItem)
afkCheckbox.Size = UDim2.new(0, 25, 0, 25)
afkCheckbox.Position = UDim2.new(0, 0, 0.5, -12.5)
afkCheckbox.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
afkCheckbox.Text = ""  -- AWALNYA KOSONG
afkCheckbox.TextColor3 = Color3.fromRGB(255, 255, 255)
afkCheckbox.Font = Enum.Font.GothamBold
afkCheckbox.TextSize = 16
afkCheckbox.BorderSizePixel = 0
Instance.new("UICorner", afkCheckbox).CornerRadius = UDim.new(0, 5)

local afkLabel = Instance.new("TextLabel", afkItem)
afkLabel.Size = UDim2.new(1, -35, 1, 0)
afkLabel.Position = UDim2.new(0, 30, 0, 0)
afkLabel.BackgroundTransparency = 1
afkLabel.Text = "AFK"
afkLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
afkLabel.Font = Enum.Font.GothamBold
afkLabel.TextSize = 13
afkLabel.TextXAlignment = Enum.TextXAlignment.Left

--// Radar Checklist
local radarItem = Instance.new("Frame", checklistContainer)
radarItem.Size = UDim2.new(1, 0, 0, 30)
radarItem.BackgroundTransparency = 1

local radarCheckbox = Instance.new("TextButton", radarItem)
radarCheckbox.Size = UDim2.new(0, 25, 0, 25)
radarCheckbox.Position = UDim2.new(0, 0, 0.5, -12.5)
radarCheckbox.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
radarCheckbox.Text = ""  -- AWALNYA KOSONG
radarCheckbox.TextColor3 = Color3.fromRGB(255, 255, 255)
radarCheckbox.Font = Enum.Font.GothamBold
radarCheckbox.TextSize = 16
radarCheckbox.BorderSizePixel = 0
Instance.new("UICorner", radarCheckbox).CornerRadius = UDim.new(0, 5)

local radarLabel = Instance.new("TextLabel", radarItem)
radarLabel.Size = UDim2.new(1, -35, 1, 0)
radarLabel.Position = UDim2.new(0, 30, 0, 0)
radarLabel.BackgroundTransparency = 1
radarLabel.Text = "RADAR"
radarLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
radarLabel.Font = Enum.Font.GothamBold
radarLabel.TextSize = 13
radarLabel.TextXAlignment = Enum.TextXAlignment.Left

--// Status Label
local statusLabel = Instance.new("TextLabel", fishingContent)
statusLabel.Size = UDim2.new(1, 0, 0, 20)
statusLabel.Position = UDim2.new(0, 0, 0, 195)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Status: Ready"
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 11
statusLabel.TextXAlignment = Enum.TextXAlignment.Left

--// TOMBOL SELL ALL FISH (DIKECILKAN)
local sellAllBtn = Instance.new("TextButton", fishingContent)
sellAllBtn.Size = UDim2.new(1, 0, 0, 30) -- DIKECILKAN dari 40 ke 30
sellAllBtn.Position = UDim2.new(0, 0, 0, 220)
sellAllBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 50)
sellAllBtn.Text = "üí∞ SELL ALL FISH"
sellAllBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
sellAllBtn.Font = Enum.Font.GothamBold
sellAllBtn.TextSize = 12 -- DIKECILKAN dari 13 ke 12
sellAllBtn.BorderSizePixel = 0
Instance.new("UICorner", sellAllBtn).CornerRadius = UDim.new(0, 8)

-- Logic Fishing
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local net = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net")

local RequestFishingMinigameStarted = net:WaitForChild("RF/RequestFishingMinigameStarted")
local ChargeFishingRod = net:WaitForChild("RF/ChargeFishingRod")
local FishingCompleted = net:WaitForChild("RE/FishingCompleted")
local UpdateFishingRadar = net:WaitForChild("RF/UpdateFishingRadar")
local SellAllItems = net:WaitForChild("RF/SellAllItems")

-- Variabel GLOBAL untuk state (DIPERBAIKI)
local minigameDelay = 2.5
local running = false
local radarActive = false
local autoTouchActive = false
local touchCooldown = 300
local timeUntilNextTouch = touchCooldown
local touchConnection = nil

-- Variabel untuk Freeze
local frozen = false
local freezePos
local freezeConnection

-- VARIABEL UNTUK ANIMASI (DIPERBAIKI)
local animTrack = nil
local anim = Instance.new("Animation")
anim.AnimationId = "rbxassetid://110413869466904"

-- FUNGSI UNTUK RESET STATE SETELAH RESPAWN (DIPERBAIKI)
local function resetAfterRespawn()
	-- Reset semua state ke false
	running = false
	radarActive = false
	autoTouchActive = false
	frozen = false
	
	-- Update checkbox UI
	toggleCheckbox(autoFishingCheckbox, false)
	toggleCheckbox(freezeCheckbox, false)
	toggleCheckbox(afkCheckbox, false)
	toggleCheckbox(radarCheckbox, false)
	
	-- Hentikan semua connections
	if touchConnection then
		touchConnection:Disconnect()
		touchConnection = nil
	end
	
	if freezeConnection then
		freezeConnection:Disconnect()
		freezeConnection = nil
	end
	
	-- Hentikan animasi
	if animTrack then
		animTrack:Stop()
		animTrack:Destroy()
		animTrack = nil
	end
	
	-- Update status
	statusLabel.Text = "Status: Respawned - Ready"
end

-- Fungsi untuk mendapatkan humanoid yang aktif (DIPERBAIKI)
local function getCurrentHumanoid()
	local character = player.Character
	if character then
		return character:FindFirstChildOfClass("Humanoid")
	end
	return nil
end

-- Fungsi untuk memainkan animasi (DIPERBAIKI)
local function playFishingAnimation()
	local humanoid = getCurrentHumanoid()
	if humanoid and running then
		-- Hentikan animasi lama jika ada
		if animTrack then
			animTrack:Stop()
			animTrack:Destroy()
		end
		
		-- Buat animasi baru
		animTrack = humanoid:LoadAnimation(anim)
		if animTrack then
			animTrack:Play()
		end
	end
end

-- Fungsi untuk menghentikan animasi (DIPERBAIKI)
local function stopFishingAnimation()
	if animTrack then
		animTrack:Stop()
		animTrack:Destroy()
		animTrack = nil
	end
end

-- Event untuk handle character respawn (DIPERBAIKI TOTAL)
player.CharacterAdded:Connect(function(character)
	-- Tunggu humanoid tersedia
	character:WaitForChild("Humanoid")
	
	-- Reset semua state setelah respawn
	resetAfterRespawn()
	
	statusLabel.Text = "Status: Character Loaded - Ready"
end)

-- Fungsi toggle checklist (TANPA WARNA HIJAU)
local function toggleCheckbox(checkbox, isActive)
    if isActive then
        checkbox.Text = "‚úì"  -- ADA CHECKLIST KETIKA AKTIF
    else
        checkbox.Text = ""  -- KOSONG KETIKA NON-AKTIF
    end
end

-- üßä Fungsi Freeze (DIPERBAIKI)
local function toggleFreeze()
    -- Cek apakah character ada
    if not player.Character then
        statusLabel.Text = "Error: No character found!"
        return
    end
    
    frozen = not frozen
    toggleCheckbox(freezeCheckbox, frozen)
    
    if frozen then
        local character = player.Character
        local root = character:WaitForChild("HumanoidRootPart")
        freezePos = root.CFrame
        statusLabel.Text = "Freeze: ON - Position Locked"

        freezeConnection = RunService.Heartbeat:Connect(function()
            if character and root and character.Parent ~= nil then
                -- Lock posisi dan kecepatan
                root.AssemblyLinearVelocity = Vector3.zero
                root.AssemblyAngularVelocity = Vector3.zero
                
                local dist = (root.Position - freezePos.Position).Magnitude
                if dist > 0.1 then
                    root.CFrame = freezePos
                end
            else
                -- Character hilang, matikan freeze
                if freezeConnection then
                    freezeConnection:Disconnect()
                    freezeConnection = nil
                end
            end
        end)
    else
        statusLabel.Text = "Freeze: OFF"
        if freezeConnection then
            freezeConnection:Disconnect()
            freezeConnection = nil
        end
    end
end

-- Event handler untuk Freeze
freezeCheckbox.MouseButton1Click:Connect(toggleFreeze)

-- Hover effects untuk Freeze
freezeCheckbox.MouseEnter:Connect(function()
    game:GetService("TweenService"):Create(freezeCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
end)

freezeCheckbox.MouseLeave:Connect(function()
    game:GetService("TweenService"):Create(freezeCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
end)

-- Fungsi untuk melakukan auto touch
local function performAutoTouch()
    if autoTouchActive then
        local screenCenter = Vector2.new(gui.AbsoluteSize.X / 2, gui.AbsoluteSize.Y / 2)
        
        local touchInput = {
            Position = screenCenter,
            UserInputType = Enum.UserInputType.Touch,
            KeyCode = Enum.KeyCode.Unknown
        }
        
        UserInputService:GetPropertyChangedSignal("MouseEnabled"):Wait()
        timeUntilNextTouch = touchCooldown
        statusLabel.Text = "Last AFK touch: " .. os.date("%H:%M:%S")
    end
end

-- Fungsi untuk memulai/menghentikan auto touch
local function toggleAutoTouch()
    -- Cek apakah character ada
    if not player.Character then
        statusLabel.Text = "Error: No character found!"
        return
    end
    
    autoTouchActive = not autoTouchActive
    toggleCheckbox(afkCheckbox, autoTouchActive)
    
    if autoTouchActive then
        statusLabel.Text = "AFK Mode: Active"
        
        if touchConnection then
            touchConnection:Disconnect()
        end
        
        touchConnection = game:GetService("RunService").Heartbeat:Connect(function(deltaTime)
            if autoTouchActive then
                timeUntilNextTouch = timeUntilNextTouch - deltaTime
                if timeUntilNextTouch <= 0 then
                    performAutoTouch()
                end
            end
        end)
        
        performAutoTouch()
    else
        statusLabel.Text = "AFK Mode: Off"
        
        if touchConnection then
            touchConnection:Disconnect()
            touchConnection = nil
        end
    end
end

-- Event handler untuk checkbox AFK
afkCheckbox.MouseButton1Click:Connect(toggleAutoTouch)

-- Hover effects untuk checkbox AFK
afkCheckbox.MouseEnter:Connect(function()
    game:GetService("TweenService"):Create(afkCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
end)

afkCheckbox.MouseLeave:Connect(function()
    game:GetService("TweenService"):Create(afkCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
end)

local function safeInvoke(remote, args)
	local ok, err = pcall(function()
		return remote:InvokeServer(unpack(args or {}))
	end)
	if not ok then 
		-- Tidak menampilkan status error
	end
end

-- Fungsi start fishing (DIPERBAIKI)
local function startFishing()
	while running do
		-- Cek apakah character masih ada
		if not player.Character then
			statusLabel.Text = "Auto Fishing: Waiting for character..."
			player.CharacterAdded:Wait()
			task.wait(2) -- Tunggu character fully loaded
			statusLabel.Text = "Auto Fishing: Active"
			-- Mainkan animasi lagi setelah respawn
			playFishingAnimation()
		end
		
		safeInvoke(ChargeFishingRod, {1760343672.039884})
		task.wait(0.4)
		
		safeInvoke(RequestFishingMinigameStarted, {-1.233184814453125, 0.9923086299438229})
		task.wait(minigameDelay)
		
		pcall(function() FishingCompleted:FireServer() end)
		task.wait(0.15)
	end
end

-- Event handler untuk Auto Fishing (DIPERBAIKI)
autoFishingCheckbox.MouseButton1Click:Connect(function()
    -- Cek apakah character ada
    if not player.Character then
        statusLabel.Text = "Error: No character found!"
        return
    end
    
	running = not running
	toggleCheckbox(autoFishingCheckbox, running)
	
	if running then
		statusLabel.Text = "Auto Fishing: Starting..."
		-- Mainkan animasi terlebih dahulu
		playFishingAnimation()
		statusLabel.Text = "Auto Fishing: Active"
		-- Jalankan fishing loop
		task.spawn(startFishing)
	else
		statusLabel.Text = "Auto Fishing: Stopped"
		-- Hentikan animasi
		stopFishingAnimation()
	end
end)

-- Hover effects untuk Auto Fishing
autoFishingCheckbox.MouseEnter:Connect(function()
    game:GetService("TweenService"):Create(autoFishingCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
end)

autoFishingCheckbox.MouseLeave:Connect(function()
    game:GetService("TweenService"):Create(autoFishingCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
end)

-- Event handler untuk Radar
radarCheckbox.MouseButton1Click:Connect(function()
    -- Cek apakah character ada
    if not player.Character then
        statusLabel.Text = "Error: No character found!"
        return
    end
    
	radarActive = not radarActive
	toggleCheckbox(radarCheckbox, radarActive)
	
	if radarActive then
		safeInvoke(UpdateFishingRadar, {true})
		statusLabel.Text = "Radar: Active"
	else
		safeInvoke(UpdateFishingRadar, {false})
		statusLabel.Text = "Radar: Off"
	end
end)

-- Hover effects untuk Radar
radarCheckbox.MouseEnter:Connect(function()
    game:GetService("TweenService"):Create(radarCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 100)}):Play()
end)

radarCheckbox.MouseLeave:Connect(function()
    game:GetService("TweenService"):Create(radarCheckbox, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 80)}):Play()
end)

--// FUNGSI UNTUK MEMBUAT GUI KONFIRMASI SELL ALL (DIPERBAIKI)
local function createSellAllConfirmation()
	if coregui:FindFirstChild("SellAllConfirmation") then
		coregui.SellAllConfirmation:Destroy()
	end
	
	local confirmationGui = Instance.new("ScreenGui", coregui)
	confirmationGui.Name = "SellAllConfirmation"
	confirmationGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	confirmationGui.ResetOnSpawn = false
	
	local confirmFrame = Instance.new("Frame", confirmationGui)
	confirmFrame.Size = UDim2.new(0, 280, 0, 160)
	confirmFrame.Position = UDim2.new(0.5, -140, 0.5, -80)
	confirmFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
	confirmFrame.BackgroundTransparency = 0.1
	confirmFrame.BorderSizePixel = 0
	confirmFrame.Active = true
	confirmFrame.Draggable = true
	Instance.new("UICorner", confirmFrame).CornerRadius = UDim.new(0, 12)
	
	local confirmBorder = Instance.new("Frame", confirmFrame)
	confirmBorder.Size = UDim2.new(1, 4, 1, 4)
	confirmBorder.Position = UDim2.new(0, -2, 0, -2)
	confirmBorder.BackgroundColor3 = Color3.fromRGB(255, 150, 50)
	confirmBorder.BackgroundTransparency = 0.8
	confirmBorder.BorderSizePixel = 0
	confirmBorder.ZIndex = 0
	Instance.new("UICorner", confirmBorder).CornerRadius = UDim.new(0, 14)
	
	local confirmGradient = Instance.new("UIGradient", confirmFrame)
	confirmGradient.Rotation = 90
	confirmGradient.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(35, 35, 45)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(25, 25, 35))
	})
	
	local warningIcon = Instance.new("TextLabel", confirmFrame)
	warningIcon.Size = UDim2.new(1, 0, 0, 30)
	warningIcon.Position = UDim2.new(0, 0, 0, 10)
	warningIcon.BackgroundTransparency = 1
	warningIcon.Text = "‚ö†Ô∏è KONFIRMASI SELL ALL"
	warningIcon.TextColor3 = Color3.fromRGB(255, 200, 100)
	warningIcon.Font = Enum.Font.GothamBold
	warningIcon.TextSize = 14
	warningIcon.TextXAlignment = Enum.TextXAlignment.Center
	
	local warningText = Instance.new("TextLabel", confirmFrame)
	warningText.Size = UDim2.new(1, -20, 0, 50)
	warningText.Position = UDim2.new(0, 10, 0, 40)
	warningText.BackgroundTransparency = 1
	warningText.Text = "Favoritkan dulu ikan mu sebelum sell all supaya tidak terjual semua!"
	warningText.TextColor3 = Color3.fromRGB(220, 220, 255)
	warningText.Font = Enum.Font.Gotham
	warningText.TextSize = 11
	warningText.TextWrapped = true
	warningText.TextXAlignment = Enum.TextXAlignment.Center
	warningText.TextYAlignment = Enum.TextYAlignment.Top
	
	local buttonContainer = Instance.new("Frame", confirmFrame)
	buttonContainer.Size = UDim2.new(1, -20, 0, 35)
	buttonContainer.Position = UDim2.new(0, 10, 1, -45)
	buttonContainer.BackgroundTransparency = 1
	
	local cancelBtn = Instance.new("TextButton", buttonContainer)
	cancelBtn.Size = UDim2.new(0.45, 0, 1, 0)
	cancelBtn.Position = UDim2.new(0, 0, 0, 0)
	cancelBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 120)
	cancelBtn.Text = "CANCEL"
	cancelBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	cancelBtn.Font = Enum.Font.GothamBold
	cancelBtn.TextSize = 12
	cancelBtn.BorderSizePixel = 0
	Instance.new("UICorner", cancelBtn).CornerRadius = UDim.new(0, 6)
	
	local sellBtn = Instance.new("TextButton", buttonContainer)
	sellBtn.Size = UDim2.new(0.45, 0, 1, 0)
	sellBtn.Position = UDim2.new(1, -120, 0, 0)
	sellBtn.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
	sellBtn.Text = "JUAL"
	sellBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	sellBtn.Font = Enum.Font.GothamBold
	sellBtn.TextSize = 12
	sellBtn.BorderSizePixel = 0
	Instance.new("UICorner", sellBtn).CornerRadius = UDim.new(0, 6)
	
	cancelBtn.MouseEnter:Connect(function()
		game:GetService("TweenService"):Create(cancelBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 120, 140)}):Play()
	end)
	cancelBtn.MouseLeave:Connect(function()
		game:GetService("TweenService"):Create(cancelBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 120)}):Play()
	end)
	
	sellBtn.MouseEnter:Connect(function()
		game:GetService("TweenService"):Create(sellBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 120, 120)}):Play()
	end)
	sellBtn.MouseLeave:Connect(function()
		game:GetService("TweenService"):Create(sellBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 100, 100)}):Play()
	end)
	
	local function closeConfirmation()
		confirmationGui:Destroy()
	end
	
	cancelBtn.MouseButton1Click:Connect(closeConfirmation)
	
	sellBtn.MouseButton1Click:Connect(function()
		local originalText = sellAllBtn.Text
		local originalColor = sellAllBtn.BackgroundColor3
		
		game:GetService("TweenService"):Create(sellAllBtn, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(200, 120, 30)}):Play()
		sellAllBtn.Text = "üîÑ SELLING..."
		statusLabel.Text = "Selling fish..."
		
		local success, result = pcall(function()
			return SellAllItems:InvokeServer()
		end)
		
		task.wait(0.5)
		
		if success then
			sellAllBtn.Text = "‚úÖ SOLD!"
			statusLabel.Text = "Fish sold successfully!"
			task.wait(1.5)
		else
			sellAllBtn.Text = "‚ùå FAILED!"
			statusLabel.Text = "Sell failed!"
			task.wait(1.5)
		end
		
		sellAllBtn.Text = originalText
		sellAllBtn.BackgroundColor3 = originalColor
		statusLabel.Text = "Ready"
		
		closeConfirmation()
	end)
	
	return confirmationGui
end

sellAllBtn.MouseButton1Click:Connect(function()
	createSellAllConfirmation()
end)

sellAllBtn.MouseEnter:Connect(function()
	game:GetService("TweenService"):Create(sellAllBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 170, 70)}):Play()
end)
sellAllBtn.MouseLeave:Connect(function()
	game:GetService("TweenService"):Create(sellAllBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 150, 50)}):Play()
end)

--// LOKASI TAB - Design Modern
local lokasiFrame = Instance.new("Frame", content)
lokasiFrame.Size = UDim2.new(1, 0, 1, 0)
lokasiFrame.BackgroundTransparency = 1
lokasiFrame.Visible = false
frames["Lokasi"] = lokasiFrame

local scrollFrame = Instance.new("ScrollingFrame", lokasiFrame)
scrollFrame.Size = UDim2.new(1, 0, 1, 0)
scrollFrame.Position = UDim2.new(0, 0, 0, 0)
scrollFrame.BackgroundTransparency = 1
scrollFrame.BorderSizePixel = 0
scrollFrame.ScrollBarThickness = 3
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(70, 130, 255)
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 320)

local uiListLayout = Instance.new("UIListLayout", scrollFrame)
uiListLayout.Padding = UDim.new(0, 6)
uiListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local teleports = {
	{name = "üèùÔ∏è Fisherman Island", pos = Vector3.new(57.79, 17.03, 2837.21)},
	{name = "üå∏ Kohana", pos = Vector3.new(-659.68, 17.25, 447.27)},
	{name = "üåã Kohana Volkano", pos = Vector3.new(-631.64, 56.52, 204.75)},
	{name = "üê† Coral Reefs", pos = Vector3.new(-3142.84, 3.37, 2130.26)},
	{name = "üåä Esoteric Depths", pos = Vector3.new(3256.75, -1300.66, 1393.43)},
	{name = "üå¥ Tropical Grove", pos = Vector3.new(-2064.34, 6.26, 3655.67)},
	{name = "üí´ Crater Island", pos = Vector3.new(1010.25, 22.27, 5080.05)},
	{name = "üíé Treasure Room", pos = Vector3.new(-3598.42, -279.73, -1633.82)},
	{name = "üóø Sisyphus Statue", pos = Vector3.new(-3698.62, -135.58, -1022.3)},
	{name = "üåø Ancient Jungle", pos = Vector3.new(1274.1, 7.85, -196.86)},
}

for i, info in ipairs(teleports) do
	local btn = Instance.new("TextButton", scrollFrame)
	btn.Size = UDim2.new(1, -8, 0, 30)
	btn.Text = info.name
	btn.BackgroundColor3 = Color3.fromRGB(50, 100, 200)
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 12
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
	
	btn.MouseEnter:Connect(function()
		game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(70, 130, 255)}):Play()
	end)
	
	btn.MouseLeave:Connect(function()
		game:GetService("TweenService"):Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(50, 100, 200)}):Play()
	end)

	btn.MouseButton1Click:Connect(function()
		local char = player.Character or player.CharacterAdded:Wait()
		if char and char:FindFirstChild("HumanoidRootPart") then
			char:MoveTo(info.pos)
		end
	end)
end

uiListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	scrollFrame.CanvasSize = UDim2.new(0, 0, 0, uiListLayout.AbsoluteContentSize.Y + 10)
end)

--// Ganti tab function
local function switchTab(tabName)
	for name, frame in pairs(frames) do
		frame.Visible = (name == tabName)
	end
	
	for name, btn in pairs(tabButtons) do
		if name == tabName then
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(70, 130, 255)}):Play()
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(255, 255, 255)}):Play()
		else
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(40, 40, 50)}):Play()
			game:GetService("TweenService"):Create(btn, TweenInfo.new(0.3), {TextColor3 = Color3.fromRGB(200, 200, 220)}):Play()
		end
	end
end

-- Create tabs
local fishingTabBtn = createTab("Fishing", "üé£ Fishing")
local lokasiTabBtn = createTab("Lokasi", "üìç Lokasi")

fishingTabBtn.MouseButton1Click:Connect(function()
	switchTab("Fishing")
end)

lokasiTabBtn.MouseButton1Click:Connect(function()
	switchTab("Lokasi")
end)

--// MINIMIZE & CLOSE LOGIC
minimizeBtn.MouseButton1Click:Connect(function()
	gui.Enabled = false
	minimizedGui.Enabled = true
end)

closeBtn.MouseButton1Click:Connect(function()
	gui.Enabled = false
	minimizedGui.Enabled = false
	
	if autoTouchActive then
		toggleAutoTouch()
	end
	if frozen then
		toggleFreeze()
	end
	if running then
		running = false
		stopFishingAnimation()
		toggleCheckbox(autoFishingCheckbox, false)
	end
end)

floatingBtn.MouseButton1Click:Connect(function()
	gui.Enabled = true
	minimizedGui.Enabled = false
end)

minimizeBtn.MouseEnter:Connect(function()
	game:GetService("TweenService"):Create(minimizeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 200, 50)}):Play()
end)
minimizeBtn.MouseLeave:Connect(function()
	game:GetService("TweenService"):Create(minimizeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 180, 0)}):Play()
end)

closeBtn.MouseEnter:Connect(function()
	game:GetService("TweenService"):Create(closeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 100, 100)}):Play()
end)
closeBtn.MouseLeave:Connect(function()
	game:GetService("TweenService"):Create(closeBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 80, 80)}):Play()
end)

switchTab("Fishing")